# Internal_Assessment_Extractor

A robust, modular Python tool for extracting assessment questions and answers from structured Microsoft Word documents. This project is designed to parse facilitator guides and generate assessment and marking guides, enabling easier processing, reporting, and export of assessment data for educational and training contexts.

---

## Table of Contents

* [Overview](#overview)
* [Features](#features)
* [Project Structure](#project-structure)
* [Installation](#installation)
* [Usage](#usage)
* [Recent Changes](#recent-changes)
* [File Management and Privacy](#file-management-and-privacy)
* [Contributing](#contributing)
* [License](#license)
* [Contact](#contact)

---

## Overview

This project automates the extraction of assessment questions, answers, and marks from DOCX files that follow specific styling conventions (such as heading levels and table structures). It supports exporting the extracted data as pandas DataFrames, Word documents, and Excel files, and lays the groundwork for integration with CI/CD pipelines and future automation.

---

## Features

* **DOCX Parsing:**  
  Parses Microsoft Word documents using heading styles (e.g., Heading 1 for chapters, Heading 2 for processes) to extract structured content.
* **Table of Contents Cross-Check:**  
  Optionally validates document structure against the Table of Contents for consistency.
* **Concept Check Extraction:**  
  Extracts "CONCEPT CHECK" style questions and answers from tables, supporting a variety of assessment formats.
* **Data Aggregation:**  
  Aggregates extracted content into structured pandas DataFrames for further analysis or export.
* **Export Capabilities:**  
  Supports exporting results into Word and Excel documents for easy sharing and reporting.
* **Modular Codebase:**  
  Cleaner, analysis, injector, and summary modules for robust, maintainable, and extensible data processing.
* **Detailed Assessment Summary:**  
  Provides detailed breakdowns and logging of parsed assessment data for reporting and QA.
* **Future Features (Planned):**
  * File browser GUI for local file selection.
  * Printing capabilities.
  * Toggleable automation for CI/CD pipelines.
  * Template-based document injection for custom output formats.

---

## Project Structure

```text
src/
├── analysis.py              # Data sorting, aggregation, and basic reporting helpers
├── assessment_summary.py    # Detailed breakdown and logging of parsed assessment data
├── cleaner.py               # Data cleaning and preprocessing utilities
├── doc_parser.py            # Parses DOCX files for chapters, processes, and Q&A
├── exporter.py              # Exporting data to Word, Excel, etc.
├── injector.py              # Injects cleaned data into templates (basic DOCX cell injection)
├── main.py                  # Entry point for running the workflow
input/                       # Place your DOCX files here (not tracked by git)
output/                      # Output files generated by the scripts
templates/                   # Document templates for injection (not tracked by git except sample)
tests/                       # Unit and integration tests
requirements.txt             # Python dependencies
README.md                    # This file
```

---

## Installation

### Prerequisites

* Python 3.8 or later
* pip package manager

### Setup

Clone the repository and install dependencies:

```bash
git clone https://github.com/PolyglotScott/internal_assessment_extractor.git
cd internal_assessment_extractor
python -m venv venv
# On Windows:
venv\Scripts\activate
# On macOS/Linux:
source venv/bin/activate
pip install -r requirements.txt
```

---

## Usage

1. **Place your DOCX files in the `input/` folder.**  
   All input documents should be placed here. This folder is ignored by git to protect sensitive data.

2. **Run the main script:**

   ```bash
   python -m src.main
   ```

   By default, the script will use the first `.docx` file found in the `input/` directory.

3. **Run the parser directly and specify an input file (optional):**

   ```bash
   python -m src.doc_parser --input input/your_document.docx
   ```

   After parsing, the script will print a summary and can export results to Word or Excel (see `exporter.py`).

---

## Recent Changes

### Directory & File Structure

* **Added `assessment_summary.py`** for detailed breakdown and logging of parsed assessment data.
* **Added `templates/` directory** for storing document templates used by the injector module.
* Updated `.gitignore` to exclude the `templates/` directory and all `.docx` files, except for `templates/assessment_template.docx` and `sample_outputs/sample_export.docx`.

### Python Modules

#### `main.py`

* Refactored for Pylint compliance: fixed line lengths, added docstrings, and improved import order.
* All imports use relative paths for package consistency.
* Progress bar and workflow logic improved for clarity and maintainability.

#### `analysis.py`

* Reduced the number of local variables in functions.
* Split long lines to comply with Pylint's 100-character limit.
* Added or improved function docstrings.
* Improved logging and summary breakdown logic.
* Moved detailed breakdown logic to `assessment_summary.py` for better modularity.

#### `assessment_summary.py`

* **New module** for logging a detailed breakdown of chapters, processes, subsections, question types, questions, and answers.
* Refactored with helper functions for chapters, processes, subsections, and question types.
* All functions now include verbose docstrings and comply with Pylint line length requirements.

#### `cleaner.py`

* Added comprehensive docstrings to all functions.
* Refactored for clarity and Pylint compliance.
* Ensured no duplicate function definitions.
* Improved multiprocessing logic for data cleaning.

#### `injector.py`

* Refactored for Pylint compliance: fixed import order, removed unused arguments, and added docstrings.
* Now expects templates in the `templates/` directory.
* Functionality is a placeholder for future template injection features.
* Added a basic function to inject a value into a specific DOCX table cell.

#### `doc_parser.py`

* Refactored for Pylint compliance: fixed import order, line lengths, and added robust docstrings.
* Improved error handling and logging.
* Cleaned up main execution logic for clarity.
* Variable naming improved to avoid Pylint false positives.

#### `exporter.py`

* Handles exporting cleaned and analyzed data to Word and Excel formats.

---

## File Management and Privacy

> **IMPORTANT:**  
> Sensitive and private files (e.g., input DOCX containing proprietary content or personal data) should **not** be committed to this repository.  
> The `.gitignore` is configured to exclude:
>
> * `input/*.docx`
> * `output/*`
> * `templates/*`
> * Any environment or credential files

---

## Contributing

Contributions are welcome! Please follow these steps for submitting changes:

1. **Fork the repository**  
   This creates your own copy of the project.

2. **Create a feature branch**  

   ```bash
   git checkout -b feature/my-feature
   ```

3. **Commit your changes**  

   ```bash
   git commit -m 'Add new feature'
   ```

4. **Push to your branch**  

   ```bash
   git push origin feature/my-feature
   ```

5. **Open a Pull Request**  
   Submit your PR for review and feedback.

---

## License

This project is licensed under the MIT License. See the LICENSE file for details.

---

## Contact

Scott Maxwell  
Polyglot Scott  
[LinkedIn](https://www.linkedin.com/in/polyglotscott/)  
[GitHub](https://github.com/PolyglotScott)  
Email: [scott.maxwell.polyglot@gmail.com](mailto:scott.maxwell.polyglot@gmail.com)

---

---

## VERBOSE AND ROBUST COMMENTS

* **All modules now include detailed docstrings** for every function and class, describing arguments, return values, and side effects.
* **Helper functions** have been introduced in `assessment_summary.py` to break down complex logic and improve maintainability.
* **Logging** is used throughout for transparency and debugging, with clear info-level messages for each processing step.
* **Error handling** is robust, with explicit exceptions and user-friendly error messages for missing files, invalid input, or processing errors.
* **Pylint compliance** is enforced across the codebase, including line length, variable naming, and function complexity.
* **Modularity** is prioritized: each module has a single responsibility and can be tested or extended independently.
* **Privacy and security** are considered: sensitive data is never tracked by git, and all input/output folders are ignored by default.
* **Extensibility** is built-in: the codebase is ready for future features such as GUI integration, advanced template injection, and CI/CD automation.

---

*Thank you for checking out internal_assessment_extractor! Feel free to explore, use, and contribute. If you have questions or suggestions, please reach out!*
